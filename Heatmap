import pandas as pd
import seaborn as sns
import matplotlib.pyplot as plt

# Excel laden
df = pd.read_excel("Heatmap.xlsx")

# Pivot-Tabelle: Idiom = Zeilen, Fehlertyp = Spalten
pivot_table = df.pivot_table(
    index="Idiom", 
    columns="Fehlertyp", 
    values="HÃ¤ufigkeit", 
    aggfunc="sum"
).fillna(0)

# Plot
plt.figure(figsize=(10,6))
sns.heatmap(pivot_table, annot=True, cmap="Reds", fmt=".0f", cbar=True)

plt.title("Fehlertypen pro Idiom", fontsize=14)
plt.xlabel("Fehlertyp", fontsize=12)
plt.ylabel("Idiom", fontsize=12)
plt.tight_layout()
plt.show()

files.download("Heatmap.png")
